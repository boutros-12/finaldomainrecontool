<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Domain Reconnaissance Tool</title>
<style>
body { font-family: Arial; max-width: 900px; margin: 40px auto; padding: 0 20px; }
input, button { font-size: 16px; }
input { width: 65%; padding: 8px; }
button { padding: 8px 14px; cursor: pointer; }
.error { color: red; }
.loading { font-style: italic; color: #555; display: none; }
.output-box { background: #f4f4f4; padding: 12px; border: 1px solid #ccc; overflow-x: auto; margin-top: 10px; }
</style>
</head>
<body>
<h1>Domain Reconnaissance Tool</h1>

<h3>Domain Lookup</h3>
<input id="domainInput" placeholder="example.com" onkeypress="if(event.key==='Enter') runRecon()">
<button onclick="runRecon()">Run Recon</button>
<div id="loading" class="loading">Loading...</div>
<div class="error" id="error"></div>
<div id="output"></div><hr>

<h3>IP Lookup (IPinfo)</h3>
<input id="ipinfoInput" placeholder="8.8.8.8" onkeypress="if(event.key==='Enter') runIpinfo()">
<button onclick="runIpinfo()">Lookup</button>
<div id="loadingIpinfo" class="loading">Loading...</div>
<div class="error" id="errorIpinfo"></div>
<div id="outputIpinfo"></div><hr>

<h3>IP Reputation (AbuseIPDB)</h3>
<input id="abuseIpInput" placeholder="8.8.8.8" onkeypress="if(event.key==='Enter') runAbuseIPDB()">
<button onclick="runAbuseIPDB()">Check</button>
<div id="loadingAbuse" class="loading">Loading...</div>
<div class="error" id="errorAbuse"></div>
<div id="outputAbuse"></div><hr>

<h3>Subdomain Enumeration (Subfinder)</h3>
<input id="subfinderDomainInput" placeholder="example.com" onkeypress="if(event.key==='Enter') runSubfinder()">
<button onclick="runSubfinder()">Find</button>
<div id="loadingSubfinder" class="loading">Scanning...</div>
<div class="error" id="errorSubfinder"></div>
<div id="outputSubfinder"></div><hr>

<script>
function validateDomain(name){return /^[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(name);}
function validateIPv4(ip){return /^(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}$/.test(ip);}

async function runRecon(){
  error.textContent=''; output.innerHTML=''; loading.style.display='block';
  const val=domainInput.value.trim(); if(!validateDomain(val)) return error.textContent='Invalid domain';
  try{const r=await fetch(`/api/recon?domain=${encodeURIComponent(val)}`);
      loading.style.display='none'; const d=await r.json();
      output.innerHTML=`<div class="output-box"><pre>${JSON.stringify(d,null,2)}</pre></div>`;}
  catch(e){loading.style.display='none'; error.textContent=e;}
}

async function runIpinfo(){
  errorIpinfo.textContent=''; outputIpinfo.innerHTML=''; loadingIpinfo.style.display='block';
  const ip=ipinfoInput.value.trim(); if(!validateIPv4(ip)) return errorIpinfo.textContent='Invalid IPv4';
  try{const r=await fetch(`/api/ipinfo_ip?ip=${encodeURIComponent(ip)}`);
      loadingIpinfo.style.display='none'; const d=await r.json();
      outputIpinfo.innerHTML=`<div class="output-box"><pre>${JSON.stringify(d,null,2)}</pre></div>`;}
  catch(e){loadingIpinfo.style.display='none'; errorIpinfo.textContent=e;}
}

async function runAbuseIPDB(){
  errorAbuse.textContent=''; outputAbuse.innerHTML=''; loadingAbuse.style.display='block';
  const ip=abuseIpInput.value.trim(); if(!validateIPv4(ip)) return errorAbuse.textContent='Invalid IPv4';
  try{const r=await fetch(`/api/abuseipdb_ip?ip=${encodeURIComponent(ip)}`);
      loadingAbuse.style.display='none'; const d=await r.json();
      outputAbuse.innerHTML=`<div class="output-box"><pre>${JSON.stringify(d,null,2)}</pre></div>`;}
  catch(e){loadingAbuse.style.display='none'; errorAbuse.textContent=e;}
}

async function runSubfinder(){
  errorSubfinder.textContent=''; outputSubfinder.innerHTML=''; loadingSubfinder.style.display='block';
  const dom=subfinderDomainInput.value.trim(); if(!validateDomain(dom)) return errorSubfinder.textContent='Invalid domain';
  try{const r=await fetch(`/api/subdomain_scan?domain=${encodeURIComponent(dom)}`);
      loadingSubfinder.style.display='none'; const d=await r.json();
      outputSubfinder.innerHTML=`<div class="output-box"><pre>${JSON.stringify(d,null,2)}</pre></div>`;}
  catch(e){loadingSubfinder.style.display='none'; errorSubfinder.textContent=e;}
}
</script>
</body>
</html>
